<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generador de Facturas</title>
    <!-- Tailwind CSS desde CDN para un diseño moderno y responsive -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Estilos personalizados para impresión */
        @media print {
            body {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                margin: 0;
                padding: 0;
            }
            .print-hidden {
                display: none !important;
            }
            #invoice-container {
                width: 210mm;
                max-width: 210mm;
                box-shadow: none;
                margin: 0 auto;
                padding: 0;
                font-size: 10pt;
                transform: scale(0.95); /* Escala al 95% para asegurar el ajuste */
                transform-origin: top left;
            }
            #main-invoice, #advance-receipt {
                padding: 10mm;
            }
            h1 { font-size: 20pt; }
            h2 { font-size: 16pt; }
            p, input, textarea, select, span { font-size: 10pt; }
            table {
                font-size: 9pt;
                table-layout: fixed;
            }
            th, td {
                padding: 4px;
            }
            /* Acomodar la columna de descripción para que no se expanda */
            #services-tbody .description-cell {
                width: 50%;
            }
            /* SOLUCION PARA EL TEXTAREA EN IMPRESION */
            textarea {
                height: auto !important;
                overflow: visible !important;
                white-space: pre-wrap !important;
            }
        }
        input, textarea, select {
            background-color: white !important;
        }
        /* Ajuste para el símbolo de dólar en los inputs */
        .input-with-dollar {
            position: relative;
        }
        .input-with-dollar span {
            position: absolute;
            left: 10px;
            top: 50%;
            transform: translateY(-50%);
            color: #9CA3AF;
        }
        .input-with-dollar input {
            padding-left: 28px !important;
        }
        /* Estilos para el botón del menú en móvil */
        @media (max-width: 1023px) {
            #invoice-render-area {
                display: block;
                width: 100%;
            }
            #editor-panel {
                position: fixed;
                top: 0;
                left: 0;
                height: 100%;
                width: 80%;
                z-index: 10;
                transform: translateX(-100%);
                transition: transform 0.3s ease-in-out;
            }
            #editor-panel.active {
                transform: translateX(0);
            }
            .backdrop {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: rgba(0, 0, 0, 0.5);
                z-index: 5;
                display: none;
            }
            .backdrop.active {
                display: block;
            }
        }
    </style>
</head>
<body class="bg-gray-100 font-sans">
    <div class="flex flex-col lg:flex-row p-4 gap-4 items-start min-h-screen">
        <!-- Botón de menú para móvil -->
        <button id="menu-button" class="lg:hidden fixed top-4 left-4 p-2 bg-blue-500 text-white rounded-lg shadow-md z-20">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
        </button>
        <div id="backdrop" class="backdrop"></div>
        <!-- Panel de edición -->
        <div id="editor-panel" class="lg:w-1/3 bg-white p-6 rounded-2xl shadow-xl space-y-6 print-hidden overflow-y-auto max-h-screen sticky top-4">
            <h2 class="text-2xl font-bold text-blue-700">Editar Información</h2>

            <!-- Detalles de la Compañía -->
            <div class="space-y-4">
                <h3 class="text-xl font-bold text-gray-800 border-b pb-2">Tu Compañía</h3>
                <div>
                    <label class="block text-gray-600">Nombre</label>
                    <input type="text" id="company-name-input" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="Nombre de la Compañía">
                </div>
                <div>
                    <label class="block text-gray-600">Dirección</label>
                    <input type="text" id="company-address-input" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="Dirección">
                </div>
                <div>
                    <label class="block text-gray-600">Teléfono</label>
                    <input type="tel" id="company-phone-input" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="Teléfono">
                </div>
                <div>
                    <label class="block text-gray-600">Email</label>
                    <input type="email" id="company-email-input" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="Email">
                </div>
            </div>

            <!-- Detalles de la Factura -->
            <div class="space-y-4">
                <h3 class="text-xl font-bold text-gray-800 border-b pb-2">Detalles de la Factura</h3>
                <div>
                    <label class="block text-gray-600">Nº de Factura</label>
                    <input type="text" id="invoice-number-input" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="Número de Factura">
                </div>
                <div>
                    <label class="block text-gray-600">Fecha</label>
                    <input type="date" id="invoice-date-input" class="w-full p-2 border border-gray-300 rounded-lg">
                </div>
            </div>

            <!-- Detalles del Cliente -->
            <div class="space-y-4">
                <h3 class="text-xl font-bold text-gray-800 border-b pb-2">Información del Cliente</h3>
                <div>
                    <label class="block text-gray-600">Nombre</label>
                    <input type="text" id="client-name-input" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="Nombre del Cliente">
                </div>
                <div>
                    <label class="block text-gray-600">Dirección</label>
                    <input type="text" id="client-address-input" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="Dirección del Cliente">
                </div>
                <div>
                    <label class="block text-gray-600">Teléfono</label>
                    <input type="tel" id="client-phone-input" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="Teléfono del Cliente">
                </div>
                <div>
                    <label class="block text-gray-600">Email</label>
                    <input type="email" id="client-email-input" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="Email del Cliente">
                </div>
            </div>
        </div>

        <!-- Área de renderizado del invoice -->
        <div id="invoice-render-area" class="lg:w-2/3 flex-1">
            <div id="invoice-container" class="w-full max-w-3xl bg-white shadow-xl rounded-2xl overflow-hidden print:shadow-none print:m-0">
                <!-- Main Invoice Section -->
                <div id="main-invoice" class="p-6 md:p-10">
                    <!-- Header Section -->
                    <header class="flex flex-col md:flex-row justify-between items-start mb-8 border-b-2 border-gray-200 pb-6">
                        <div class="flex-1 mb-4 md:mb-0">
                            <h1 class="text-4xl font-extrabold text-blue-700">FACTURA</h1>
                        </div>
                        <!-- Información de la compañía y factura -->
                        <div class="flex-1 md:text-right">
                            <h2 class="text-2xl font-bold text-gray-800" id="display-company-name"></h2>
                            <p class="text-gray-600" id="display-company-address"></p>
                            <p class="text-gray-600">Tel: <span id="display-company-phone"></span></p>
                            <p class="text-gray-600">Email: <span id="display-company-email"></span></p>
                            <div class="mt-4 text-sm text-gray-600">
                                <p>Nº de Factura: <span id="display-invoice-number"></span></p>
                                <p>Fecha: <span id="display-invoice-date"></span></p>
                            </div>
                        </div>
                    </header>

                    <!-- Facturar a -->
                    <section class="mb-8">
                        <div class="bg-blue-50 p-6 rounded-xl shadow-inner">
                            <h3 class="text-lg font-bold mb-2 text-blue-800">Facturar a</h3>
                            <div class="flex flex-col space-y-2">
                                <p class="font-bold" id="display-client-name"></p>
                            </div>
                        </div>
                    </section>

                    <!-- Services Table -->
                    <section class="mb-8">
                        <h3 class="text-xl font-bold mb-4 text-gray-800">Descripción de los Servicios</h3>
                        <div class="overflow-x-auto">
                            <table class="w-full text-left table-auto border-collapse">
                                <thead>
                                    <tr class="bg-gray-200">
                                        <th class="py-3 px-4 font-bold text-gray-600 rounded-tl-xl">Descripción del Servicio</th>
                                        <th class="py-3 px-4 font-bold text-gray-600">Cantidad</th>
                                        <th class="py-3 px-4 font-bold text-gray-600">Precio Unitario</th>
                                        <th class="py-3 px-4 font-bold text-gray-600 rounded-tr-xl">Total</th>
                                        <th class="py-3 px-4 rounded-tr-xl print-hidden"></th>
                                    </tr>
                                </thead>
                                <tbody id="services-tbody"></tbody>
                            </table>
                        </div>
                        <button id="add-service-btn" class="mt-4 px-6 py-3 bg-blue-500 text-white font-bold rounded-lg shadow-md hover:bg-blue-600 transition duration-300 ease-in-out transform hover:scale-105 print-hidden">
                            + Agregar Servicio
                        </button>
                    </section>

                    <!-- Totals Section -->
                    <section class="flex justify-end">
                        <div class="w-full md:w-1/2">
                            <div class="bg-blue-50 p-6 rounded-xl shadow-inner space-y-4">
                                <div class="flex justify-between items-center text-gray-700">
                                    <span class="font-semibold text-lg">Subtotal:</span>
                                    <span class="text-lg">$<span id="subtotal-display"></span></span>
                                </div>
                                <div class="flex justify-between items-center text-gray-700">
                                    <span class="font-semibold text-lg">Anticipo:</span>
                                    <div class="input-with-dollar">
                                        <span>$</span>
                                        <input type="number" id="advance-payment-input" class="w-32 p-2 border border-gray-300 rounded-lg text-right focus:outline-none focus:ring-2 focus:ring-blue-500" value="0">
                                    </div>
                                </div>
                                <div class="flex justify-between items-center text-2xl font-bold text-blue-700 border-t-2 border-gray-300 pt-4">
                                    <span>Total a Pagar:</span>
                                    <span>$<span id="total-display"></span></span>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Buttons Section -->
                    <footer class="mt-8 flex flex-col sm:flex-row justify-center sm:justify-end gap-4 print-hidden">
                        <button id="print-invoice-btn" class="px-6 py-3 bg-green-500 text-white font-bold rounded-lg shadow-md hover:bg-green-600 transition duration-300 ease-in-out transform hover:scale-105">
                            Imprimir Factura (PDF)
                        </button>
                        <button id="print-advance-receipt-btn" class="px-6 py-3 bg-purple-500 text-white font-bold rounded-lg shadow-md hover:bg-purple-600 transition duration-300 ease-in-out transform hover:scale-105">
                            Imprimir Recibo de Anticipo (PDF)
                        </button>
                    </footer>
                </div>

                <!-- Advance Payment Receipt Section (initially hidden, shown for printing) -->
                <div id="advance-receipt" class="p-6 md:p-10 print-hidden">
                    <header class="flex flex-col md:flex-row justify-between items-start mb-8 border-b-2 border-gray-200 pb-6">
                        <div class="flex-1 mb-4 md:mb-0">
                            <h1 class="text-4xl font-extrabold text-purple-700">RECIBO DE ANTICIPO</h1>
                            <p class="text-gray-600">Nº de Factura: <span id="receipt-invoice-number"></span></p>
                            <p class="text-gray-600">Fecha: <span id="receipt-invoice-date"></span></p>
                        </div>
                        <!-- Información de la compañía, ahora obtenida del panel de edición -->
                        <div class="flex-1 md:text-right">
                            <h2 class="text-2xl font-bold text-gray-800" id="receipt-company-name"></h2>
                            <p class="text-gray-600" id="receipt-company-address"></p>
                            <p class="text-gray-600">Tel: <span id="receipt-company-phone"></span></p>
                            <p class="text-gray-600">Email: <span id="receipt-company-email"></span></p>
                        </div>
                    </header>
                    <div class="bg-purple-50 p-6 rounded-xl shadow-inner mb-8">
                        <h3 class="text-lg font-bold mb-2 text-purple-800">Recibo para</h3>
                        <p class="text-gray-700 font-semibold" id="receipt-client-name"></p>
                    </div>
                    <div class="flex justify-between items-center text-4xl font-bold text-purple-700 border-t-2 border-gray-300 pt-8">
                        <span>Anticipo Recibido:</span>
                        <span>$<span id="receipt-advance-amount"></span></span>
                    </div>
                    <div class="mt-16 text-center">
                        <p class="text-gray-600 mb-2">Gracias por su confianza.</p>
                        <div class="border-t border-gray-400 mt-12 w-1/2 mx-auto"></div>
                        <p class="mt-2 text-gray-600">Firma de Recibido</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Definición de los datos iniciales de la aplicación
        let company = {
            name: 'Fuente painting y service LLC',
            address: '',
            phone: '704-968732',
            email: 'fuentepainting@gmail.com'
        };
        let client = {
            name: 'Nombre del Cliente',
            address: 'Dirección del Cliente',
            phone: '555-0000',
            email: 'cliente@email.com'
        };
        let invoice = {
            number: 'INV-001',
            date: new Date().toISOString().slice(0, 10),
        };
        let services = [
            { id: 1, description: '', quantity: 1, price: 0.00 },
        ];
        let advancePayment = 0;

        // Función para actualizar los totales y el display
        function updateDisplay() {
            const subtotal = services.reduce((acc, service) => acc + (service.quantity * service.price), 0);
            const total = subtotal - advancePayment;

            const subtotalDisplay = document.getElementById('subtotal-display');
            if (subtotalDisplay) subtotalDisplay.innerText = subtotal.toFixed(2);
            
            const totalDisplay = document.getElementById('total-display');
            if (totalDisplay) totalDisplay.innerText = total.toFixed(2);

            const printReceiptBtn = document.getElementById('print-advance-receipt-btn');
            if (printReceiptBtn) {
                if (advancePayment > 0) {
                    printReceiptBtn.style.display = 'inline-block';
                    const receiptAdvanceAmount = document.getElementById('receipt-advance-amount');
                    if(receiptAdvanceAmount) receiptAdvanceAmount.innerText = advancePayment.toFixed(2);
                } else {
                    printReceiptBtn.style.display = 'none';
                }
            }
        }

        // Función para actualizar la tabla de servicios
        function updateServicesTable() {
            const tbody = document.getElementById('services-tbody');
            if (!tbody) return;

            tbody.innerHTML = services.map(service => `
                <tr class="border-b border-gray-200">
                    <td class="py-4 px-4 description-cell">
                        <textarea data-id="${service.id}" data-field="description" class="w-full p-2 border border-gray-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500">${service.description}</textarea>
                    </td>
                    <td class="py-4 px-4">
                        <input type="number" data-id="${service.id}" data-field="quantity" class="w-24 p-2 border border-gray-300 rounded-lg text-center focus:outline-none focus:ring-2 focus:ring-blue-500" value="${service.quantity}">
                    </td>
                    <td class="py-4 px-4">
                        <div class="input-with-dollar">
                            <span>$</span>
                            <input type="number" data-id="${service.id}" data-field="price" class="w-32 p-2 border border-gray-300 rounded-lg text-right focus:outline-none focus:ring-2 focus:ring-blue-500" value="${service.price.toFixed(2)}">
                        </div>
                    </td>
                    <td class="py-4 px-4 font-bold text-gray-800">
                        $${(service.quantity * service.price).toFixed(2)}
                    </td>
                    <td class="py-4 px-4 text-center print-hidden">
                        <button data-id="${service.id}" data-action="remove" class="text-red-500 hover:text-red-700 transition duration-300">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" />
                            </svg>
                        </button>
                    </td>
                </tr>
            `).join('');

            // Ajustar la altura de las textareas
            tbody.querySelectorAll('textarea').forEach(textarea => {
                textarea.style.height = 'auto';
                textarea.style.height = textarea.scrollHeight + 'px';
            });
        }

        // Función para adjuntar los manejadores de eventos
        function attachEventListeners() {
            // Manejadores para los campos del panel de edición
            document.getElementById('company-name-input').addEventListener('input', (e) => {
                company.name = e.target.value;
                document.getElementById('display-company-name').innerText = company.name;
                document.getElementById('receipt-company-name').innerText = company.name;
            });
            document.getElementById('company-address-input').addEventListener('input', (e) => {
                company.address = e.target.value;
                document.getElementById('display-company-address').innerText = company.address;
                document.getElementById('receipt-company-address').innerText = company.address;
            });
            document.getElementById('company-phone-input').addEventListener('input', (e) => {
                company.phone = e.target.value;
                document.getElementById('display-company-phone').innerText = company.phone;
                document.getElementById('receipt-company-phone').innerText = company.phone;
            });
            document.getElementById('company-email-input').addEventListener('input', (e) => {
                company.email = e.target.value;
                document.getElementById('display-company-email').innerText = company.email;
                document.getElementById('receipt-company-email').innerText = company.email;
            });

            document.getElementById('invoice-number-input').addEventListener('input', (e) => {
                invoice.number = e.target.value;
                document.getElementById('display-invoice-number').innerText = invoice.number;
                document.getElementById('receipt-invoice-number').innerText = invoice.number;
            });
            document.getElementById('invoice-date-input').addEventListener('input', (e) => {
                invoice.date = e.target.value;
                document.getElementById('display-invoice-date').innerText = invoice.date;
                document.getElementById('receipt-invoice-date').innerText = invoice.date;
            });
            
            document.getElementById('client-name-input').addEventListener('input', (e) => {
                client.name = e.target.value;
                document.getElementById('display-client-name').innerText = client.name;
                document.getElementById('receipt-client-name').innerText = client.name;
            });
            document.getElementById('client-address-input').addEventListener('input', (e) => {
                client.address = e.target.value;
                document.getElementById('display-client-address').innerText = client.address;
                document.getElementById('receipt-client-address').innerText = client.address;
            });
            document.getElementById('client-phone-input').addEventListener('input', (e) => {
                client.phone = e.target.value;
                document.getElementById('display-client-phone').innerText = client.phone;
                document.getElementById('receipt-client-phone').innerText = client.phone;
            });
            document.getElementById('client-email-input').addEventListener('input', (e) => {
                client.email = e.target.value;
                document.getElementById('display-client-email').innerText = client.email;
                document.getElementById('receipt-client-email').innerText = client.email;
            });

            // Manejadores para los campos de datos del invoice
            document.getElementById('advance-payment-input').addEventListener('input', (e) => {
                advancePayment = parseFloat(e.target.value) || 0;
                updateDisplay();
            });

            // Manejador para agregar servicio
            document.getElementById('add-service-btn').addEventListener('click', () => {
                services.push({ id: Date.now(), description: '', quantity: 1, price: 0 });
                updateServicesTable();
                updateDisplay();
            });

            // Manejadores para la tabla de servicios
            const servicesTbody = document.getElementById('services-tbody');
            if (servicesTbody) {
                servicesTbody.addEventListener('input', (e) => {
                    const target = e.target;
                    const id = parseInt(target.getAttribute('data-id'));
                    const field = target.getAttribute('data-field');
                    const value = target.value;
                    
                    if (target.tagName.toLowerCase() === 'textarea' && field === 'description') {
                        // Lógica para auto-redimensionar el textarea
                        target.style.height = 'auto';
                        target.style.height = target.scrollHeight + 'px';
                        services = services.map(service =>
                            service.id === id ? { ...service, [field]: value } : service
                        );
                    } else {
                        services = services.map(service =>
                            service.id === id ? { ...service, [field]: parseFloat(value) || 0 } : service
                        );
                    }
                    updateDisplay();
                });
                servicesTbody.addEventListener('click', (e) => {
                    const target = e.target.closest('button');
                    if (target && target.getAttribute('data-action') === 'remove') {
                        const id = parseInt(target.getAttribute('data-id'));
                        services = services.filter(service => service.id !== id);
                        updateServicesTable();
                        updateDisplay();
                    }
                });
            }

            // Manejadores de impresión
            function adjustAllTextareas() {
                document.querySelectorAll('textarea').forEach(t => {
                    t.style.height = 'auto';
                    t.style.height = t.scrollHeight + 'px';
                });
            }

            document.getElementById('print-invoice-btn').addEventListener('click', () => {
                adjustAllTextareas();
                const mainInvoice = document.getElementById('main-invoice');
                const advanceReceipt = document.getElementById('advance-receipt');
                if (mainInvoice && advanceReceipt) {
                    mainInvoice.classList.remove('print-hidden');
                    advanceReceipt.classList.add('print-hidden');
                }
                window.print();
            });
            const printReceiptBtn = document.getElementById('print-advance-receipt-btn');
            if (printReceiptBtn) {
                printReceiptBtn.addEventListener('click', () => {
                    adjustAllTextareas();
                    const mainInvoice = document.getElementById('main-invoice');
                    const advanceReceipt = document.getElementById('advance-receipt');
                    if (mainInvoice && advanceReceipt) {
                        mainInvoice.classList.add('print-hidden');
                        advanceReceipt.classList.remove('print-hidden');
                    }
                    window.print();
                });
            }
            
            // Manejador del botón del menú
            document.getElementById('menu-button').addEventListener('click', () => {
                document.getElementById('editor-panel').classList.toggle('active');
                document.getElementById('backdrop').classList.toggle('active');
            });
            document.getElementById('backdrop').addEventListener('click', () => {
                document.getElementById('editor-panel').classList.remove('active');
                document.getElementById('backdrop').classList.remove('active');
            });
        }

        // Función para actualizar el panel de edición con los datos actuales
        function updateEditorPanel() {
            document.getElementById('company-name-input').value = company.name;
            document.getElementById('company-address-input').value = company.address;
            document.getElementById('company-phone-input').value = company.phone;
            document.getElementById('company-email-input').value = company.email;
            
            document.getElementById('client-name-input').value = client.name;
            document.getElementById('client-address-input').value = client.address;
            document.getElementById('client-phone-input').value = client.phone;
            document.getElementById('client-email-input').value = client.email;

            document.getElementById('invoice-number-input').value = invoice.number;
            document.getElementById('invoice-date-input').value = invoice.date;

            // Actualizar la vista de la factura
            updateInvoiceDisplay();
        }

        function updateInvoiceDisplay() {
            const displayCompanyName = document.getElementById('display-company-name');
            if (displayCompanyName) displayCompanyName.innerText = company.name;
            
            const displayCompanyAddress = document.getElementById('display-company-address');
            if (displayCompanyAddress) displayCompanyAddress.innerText = company.address;

            const displayCompanyPhone = document.getElementById('display-company-phone');
            if (displayCompanyPhone) displayCompanyPhone.innerText = company.phone;
            
            const displayCompanyEmail = document.getElementById('display-company-email');
            if (displayCompanyEmail) displayCompanyEmail.innerText = company.email;
            
            const displayClientName = document.getElementById('display-client-name');
            if (displayClientName) displayClientName.innerText = client.name;
            
            const displayInvoiceNumber = document.getElementById('display-invoice-number');
            if (displayInvoiceNumber) displayInvoiceNumber.innerText = invoice.number;
            
            const displayInvoiceDate = document.getElementById('display-invoice-date');
            if (displayInvoiceDate) displayInvoiceDate.innerText = invoice.date;

            const receiptCompanyName = document.getElementById('receipt-company-name');
            if (receiptCompanyName) receiptCompanyName.innerText = company.name;
            
            const receiptCompanyAddress = document.getElementById('receipt-company-address');
            if (receiptCompanyAddress) receiptCompanyAddress.innerText = company.address;
            
            const receiptCompanyPhone = document.getElementById('receipt-company-phone');
            if (receiptCompanyPhone) receiptCompanyPhone.innerText = company.phone;
            
            const receiptCompanyEmail = document.getElementById('receipt-company-email');
            if (receiptCompanyEmail) receiptCompanyEmail.innerText = company.email;
            
            const receiptClientName = document.getElementById('receipt-client-name');
            if (receiptClientName) receiptClientName.innerText = client.name;
            
            const receiptInvoiceNumber = document.getElementById('receipt-invoice-number');
            if (receiptInvoiceNumber) receiptInvoiceNumber.innerText = invoice.number;
            
            const receiptInvoiceDate = document.getElementById('receipt-invoice-date');
            if (receiptInvoiceDate) receiptInvoiceDate.innerText = invoice.date;

            updateServicesTable();
            updateDisplay();
        }

        // Función de inicialización
        function initializeApp() {
            attachEventListeners(); // Adjunta los eventos una sola vez
            
            // Inicializar campos de entrada con los datos por defecto
            updateEditorPanel();
        }

        window.onload = initializeApp;
    </script>
</body>
</html>
